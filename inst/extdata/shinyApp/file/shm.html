<!DOCTYPE html>
<html>
<body>

<div align="justify">

<p>This is the core functionality. The data matrix is shown as an interactive table under Expression Matrix. In this table, rows are gene IDs and columns are samples/conditions and gene metadata, the expression values of a sample can be sorted, and a particular gene can be searched by its ID. Once a gene is selected in the table, its expression profile under each condition across different samples are mapped to matching spatial features in the aSVG and plotted as spatial heatmaps. Note, "sample" and "feature" are two equivalent terms referring to cells, tissues, organs etc. where numeric values are measured. Matching means a target sample in data matrix and a target spatial feature in aSVG image have the same identifier, and only matching features are colored in the spatial heatmaps. If multiple genes are selected, the spatial heatmaps are plotting sequentially. In multiple-layer images, if some spatial features are covered by front features and thus not visible, the front features can be selected to be transparent so as to expose covered features. 

<p> <b>Data matrix parameters: </b> On top of Expression Matrix, the first two items filter genes according to expression values. Genes with expression values at least A in at least samples of P proportion are retained. The third and fourth items filter genes according to the coefficient of variation (CV). Only genes with CV between CV1 and CV2 are kept. The initial values are set to very low or hight so that no rows are filtered out on start. "Data transform": if colors cannot well distinguish across features due to low variance or outliers, transform the data matrix by log2 or 2-base expoent (exp2). </p>

<p> <b>Spatial heatmap parameters: </b> The plot dimension can be adjusted by changing "Overall width" and "Overall height". "No. of columns" sets a number of columns to organize the subpots. If mutliple genes are selected, the spatial heatmaps of each gene are generated sequentially. All plots can be organized by "gene" or "condition" so that it is flexible to compare same gene across different conditions or same condition across different genes. "Color scheme" inputs the color ingredients for the color scale, where separaters could be comma, semicolon, single space, dot, hypen, or, underscore. The default is "purple,yellow,blue". The color scale can be build on either "Selected rows" the "All rows". On the right is the legend plot with matching features between data matrix and aSVG image are labeled. </p>

</div>

</body>
</html>







